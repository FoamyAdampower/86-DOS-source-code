This is a mixed version while transitioning to MS-DOS.

The code is very hard to understand honestly...
